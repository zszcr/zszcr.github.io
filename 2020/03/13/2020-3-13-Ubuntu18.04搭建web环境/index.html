<!DOCTYPE html>
<html lang="zh-CN">





<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/image3.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="description" content="zs0zrc&#39;s blog">
  <meta name="author" content="zs0zrc">
  <meta name="keywords" content="pwn CTF security anythings">
  <title>Ubuntu18.04搭建web环境 - zs0zrc</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css">
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css">

<link rel="stylesheet" href="/css/main.css">


  <link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css">


<!-- 自定义样式保持在最底部 -->


</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>zs0zrc</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">分类</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">关于</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">友链</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/image1.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <p class="mt-3 post-meta">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                  星期五, 三月 13日 2020, 2:54 下午
                </p>
              

              <p class="mt-1">
                
                  
                  <span class="post-meta">
                    <i class="far fa-chart-bar"></i>
                    1.5k 字
                  </span>
                

                
                  
                  <span class="post-meta">
                      <i class="far fa-clock"></i>
                      6 分钟
                  </span>
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  <span id="busuanzi_container_page_pv" class="post-meta" style="display: none">
                    <i class="far fa-eye" aria-hidden="true"></i>
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5 z-depth-3" id="board">
          <div class="post-content mx-auto" id="post">
            
              <p class="note note-warning">本文最后更新于：星期日, 四月 5日 2020, 6:40 晚上</p>
            
            <div class="markdown-body">
              <h3 id="Ubuntu18-04搭建web环境"><a href="#Ubuntu18-04搭建web环境" class="headerlink" title="Ubuntu18.04搭建web环境"></a>Ubuntu18.04搭建web环境</h3><p>如题所示，我准备在Ubuntu18.04搭建一个web环境，要安装的东西有Apache、Mysql、PHP，本来是想在直接我的服务器上捣鼓的，但是第一次搞，怕把我白嫖来的服务器搞坏，所以先拿虚拟机练练手，写篇文章记录下。</p>
<h4 id="apache2"><a href="#apache2" class="headerlink" title="apache2"></a>apache2</h4><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><blockquote>
<p>sudo apt install  apache2 -y</p>
</blockquote>
<p>安装完后可以通过访问自身ip查看apache的默认page页面，上面有一些关于apache2配置的说明，简单阅读下。</p>
<p>apahce2的配置布局如下</p>
<pre><code>/etc/apache2/
|-- apache2.conf
|       `--  ports.conf
|-- mods-enabled
|       |-- *.load
|       `-- *.conf
|-- conf-enabled
|       `-- *.conf
|-- sites-enabled
|       `-- *.conf
</code></pre><ul>
<li>apache2.conf 是主要的配置文件，在服务器启动时，它通过包含其他所有剩余的配置文件来整理各个部分。</li>
<li>ports.conf 始终包含在主配置文件中，它用于确认传入连接的监听端口，我们随时可以自定义这个文件</li>
<li>在 mods-enbaled , conf-enabled和 sites-enabled 目录下，存在着分别管理模块，全局配置片段/虚拟主机配置的特定配置片段的配置文件</li>
<li><p>因为需要使用到环境变量，所以apache2要通过 /etc/init.d/apache2或者apache2ctl来启动，使用/usr/bin/apache2的话 将无法使用默认配置</p>
</li>
<li><p>网页的根目录默认是/var/www/html，如果需要修改的话可以通过/etc/apache2/apache2.conf 来修改</p>
</li>
</ul>
<h5 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h5><ul>
<li><p>配置apache允许的用户</p>
<pre><code>创建组：groupadd apache
创建用户:useradd -r -g apache apache
</code></pre><p>在apache的配置文件apache2.conf中设置User和Group</p>
<p><img src="/picture/image-20200402110527857.png" srcset="/img/loading.gif" alt="image-20200402110527857"></p>
<p>修改网站根目录的所有者以及网站文件权限</p>
<pre><code>root@ubuntu:/var/www# chown -R apache:apache .
root@ubuntu:/var/www/html# chmod 744 -R .
</code></pre><p>重启apache</p>
<pre><code>sudo systemctl restart apache2
</code></pre></li>
</ul>
<ul>
<li><p>查看apache2配置</p>
<pre><code>sudo apachectl -S
</code></pre><p><img src="/picture/image-20200313152829219.png" srcset="/img/loading.gif" alt="image-20200313152829219">这条命令会打印出apache的配置的具体信息，其中主要的是VirtualHost configuration，它给出了apache当前使用的配置文件，要注意的是 这里显示的配置文件路径<code>/etc/apache2/sites-enabled/000-default.conf</code>这个只是一个软连接，真正的配置文件在<code>/etc/apache2/sites-available/</code>下。</p>
<p>修改完配置文件可以通过<code>sudo apache2ctl configtest</code>命令来检查配置文件语法是否正确。</p>
<p>然后执行下面两条命令使配置生效</p>
<pre><code>sudo a2ensite ××××.conf
sudo systemctl restart apache2
</code></pre></li>
</ul>
<h4 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h4><p>mysql大家应该都很熟悉了，一款数据库管理软件</p>
<h5 id="安装方法"><a href="#安装方法" class="headerlink" title="安装方法"></a>安装方法</h5><pre><code>sudo apt install mysql-server -y
</code></pre><h5 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h5><p><strong>初始化配置</strong></p>
<pre><code>zs0zrc@ubuntu:/var/www/html$ sudo mysql_secure_installation

Securing the MySQL server deployment.

Connecting to MySQL using a blank password.

VALIDATE PASSWORD PLUGIN can be used to test passwords
and improve security. It checks the strength of password
and allows the users to set only those passwords which are
secure enough. Would you like to setup VALIDATE PASSWORD plugin?

Press y|Y for Yes, any other key for No: Y

There are three levels of password validation policy:

LOW    Length &gt;= 8
MEDIUM Length &gt;= 8, numeric, mixed case, and special characters
STRONG Length &gt;= 8, numeric, mixed case, special characters and dictionary                  file

Please enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: 0
Please set the password for root here.

New password: 

Re-enter new password: 

Estimated strength of the password: 50 
Do you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : y
By default, a MySQL installation has an anonymous user,
allowing anyone to log into MySQL without having to have
a user account created for them. This is intended only for
testing, and to make the installation go a bit smoother.
You should remove them before moving into a production
environment.

Remove anonymous users? (Press y|Y for Yes, any other key for No) : y
Success.


Normally, root should only be allowed to connect from
&#39;localhost&#39;. This ensures that someone cannot guess at
the root password from the network.

Disallow root login remotely? (Press y|Y for Yes, any other key for No) : N

 ... skipping.
By default, MySQL comes with a database named &#39;test&#39; that
anyone can access. This is also intended only for testing,
and should be removed before moving into a production
environment.


Remove test database and access to it? (Press y|Y for Yes, any other key for No) : y
 - Dropping test database...
Success.

 - Removing privileges on test database...
Success.

Reloading the privilege tables will ensure that all changes
made so far will take effect immediately.

Reload privilege tables now? (Press y|Y for Yes, any other key for No) : y
Success.

All done! 

</code></pre><p>测试mysql服务是否正常</p>
<p><img src="/picture/image-20200313155719576.png" srcset="/img/loading.gif" alt="image-20200313155719576"></p>
<p><strong>远程连接配置</strong></p>
<p>因为Ubuntu下的mysql-server默认是只运行本机连接访问的，如果想远程连接的话，就要配置一下</p>
<ul>
<li><p>登录mysql</p>
<p><img src="/picture/image-20200313160702129.png" srcset="/img/loading.gif" alt="image-20200313160702129"></p>
</li>
</ul>
<ul>
<li><p>添加一个新的root用户，允许所有ip访问</p>
<pre><code>mysql&gt;GRANT ALL PRIVILEGES ON  *.*  TO root@&quot;%&quot; IDENTIFIED BY &#39;zs0zrc123456&#39;;
mysql&gt;flush privileges;
</code></pre></li>
<li><p>修改mysql配置文件</p>
<pre><code> sudo vim etc/mysql/mysql.conf.d/mysqld.cnf
</code></pre><p>将<code>bind-address = 127.0.0.1</code> 修改为 <code>bind-address = 0.0.0.0</code></p>
</li>
<li><p>重启mysql</p>
<pre><code>sudo /etc/init.d/mysql restart
</code></pre></li>
</ul>
<h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><h5 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h5><pre><code>sudo apt install php libapache2-mod-php php-mysql -y
</code></pre><h5 id="基本配置-1"><a href="#基本配置-1" class="headerlink" title="基本配置"></a>基本配置</h5><p>打开apache的配置文件</p>
<pre><code>sudo vim /etc/apache2/mods-available/dir.conf


&lt;IfModule mod_dir.c&gt;
        DirectoryIndex index.html index.cgi index.pl index.php index.xhtml index.htm
&lt;/IfModule&gt;
</code></pre><p>将index.php的位置移到 index.html前面，这个配置文件设置的是apache寻找文件的优先级。</p>
<p>重启apache</p>
<pre><code>sudo systemctl restart apache2
</code></pre><p>写个index.php测试一下是否修改成功</p>
<pre><code class="php">&lt; ? echo &quot;hello world~&quot;;?&gt;
</code></pre>
<p>然后访问就可以看apache选择了index.php文件了</p>
<p>这样，一个基本的web环境就搭建成功了。</p>
<h3 id="通过docker搭建web环境"><a href="#通过docker搭建web环境" class="headerlink" title="通过docker搭建web环境"></a>通过docker搭建web环境</h3><p><strong>更新一下怎么通过docker搭建基本web环境</strong></p>
<p>环境还是ubuntu18.04</p>
<ul>
<li><p>首先给docker加加速</p>
<p>往  /etc/docker/daemon.json  写入下面的内容：</p>
<blockquote>
<p>{“registry-mirrors”:[“<a href="https://registry.docker-cn.com&quot;]}" target="_blank" rel="noopener">https://registry.docker-cn.com&quot;]}</a> </p>
</blockquote>
<p>然后重启服务</p>
<blockquote>
<p>$ <strong>sudo</strong> systemctl daemon-reload<br>$ <strong>sudo</strong> systemctl restart docker </p>
</blockquote>
</li>
</ul>
<p>阿西吧，f**k，一直出奇奇怪怪的问题。折腾了一天，发现了个更简单的办法……直接拖对应的镜像下来就好了</p>
<p>命令：</p>
<pre><code>docker container run -p 80:80 -d \
  --rm \
  --name lamp \
  --volume &quot;$PWD/&quot;:/var/www/html \
  php:5.6-apache
</code></pre><p>参数作用：</p>
<pre><code>-p 80:80 将容器80端口映射到主机的80端口上
--rm ： 容器停止后自动删除
--name：指定容器名字
-d ：容器以后台形式运行
--volum &quot;$PWD/&quot;:/var/www/html : 将当前目录$PWD映射到容器中的/var/www/html 
</code></pre><h4 id="REFERENCE"><a href="#REFERENCE" class="headerlink" title="REFERENCE"></a>REFERENCE</h4><ul>
<li><a href="https://luomuxiaoxiao.com/?p=707" target="_blank" rel="noopener">https://luomuxiaoxiao.com/?p=707</a> </li>
<li><a href="https://blog.csdn.net/hanshileiai/article/details/46967081" target="_blank" rel="noopener">https://blog.csdn.net/hanshileiai/article/details/46967081</a> </li>
<li><a href="https://www.howtoing.com/how-to-install-the-apache-web-server-on-ubuntu-18-04-quickstart" target="_blank" rel="noopener">https://www.howtoing.com/how-to-install-the-apache-web-server-on-ubuntu-18-04-quickstart</a> </li>
<li><a href="https://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html</a> </li>
</ul>

            </div>
            <hr>
            <div>
              <p>
                
                  <span>
                <i class="iconfont icon-inbox"></i>
                    
                      <a class="hover-with-bg" href="/categories/WEB/">WEB</a>
                      &nbsp;
                    
                  </span>&nbsp;&nbsp;
                
                
              </p>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
            </div>

            
              <!-- Comments -->
              <div class="comments" id="comments">
                
                
  <script defer src="https://utteranc.es/client.js" repo="zszcr/comment" issue-term="pathname" label="utterances" theme="github-light" crossorigin="anonymous" async>
  </script>


              </div>
            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc-start"></div>
<div id="toc">
  <p class="h5"><i class="far fa-list-alt"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    </div>
    
  <div>
    
      <!-- 不蒜子统计PV -->
      
      <span id="busuanzi_container_site_pv" style="display: none">
      总访问量 <span id="busuanzi_value_site_pv"></span> 次
    </span>
    
    
      <!-- 不蒜子统计UV -->
      
      <span id="busuanzi_container_site_uv" style="display: none">
      总访客数 <span id="busuanzi_value_site_uv"></span> 人
    </span>
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js"></script>
<script src="/js/main.js"></script>


  <script src="/js/lazyload.js"></script>



  
  <script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script>
  <script>
    $(document).ready(function () {
      var navHeight = $('#navbar').height();
      var post = $('#post');
      var toc = $('#toc');
      var tocLimMax = post.offset().top + post.height() - navHeight;

      $(window).scroll(function () {
        var tocLimMin = $('#toc-start').offset().top - navHeight;
        var scroH = document.body.scrollTop + document.documentElement.scrollTop;

        if (tocLimMin <= scroH && scroH <= tocLimMax) {
          toc.css({
            'display': 'block',
            'position': 'fixed',
            'top': navHeight,
          });
        } else if (scroH <= tocLimMin) {
          toc.css({
            'position': '',
            'top': '',
          });
        } else if (scroH > tocLimMax) {
          toc.css('display', 'none');
        }
      });
      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        scrollSmooth: true,
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc > p').css('visibility', 'visible');
      }
      var offset = $('#board-ctn').css('margin-right')
      $('#toc-ctn').css({
        'right': offset
      })
    });
  </script>







  <script defer src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<!-- Plugins -->


  

  
    <!-- Google Analytics -->
    <script defer>
      (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
          (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
          m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
      })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

      ga('create', 'UA-160202176-1', 'auto');
      ga('send', 'pageview');
    </script>
  

  

  

  



  <script src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js"></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Ubuntu18.04搭建web环境&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js"></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>












</body>
</html>
